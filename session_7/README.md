<div align="justify" dir="rtl">

در پست قبلی درباره الگوی مدل دامنه حرف زدیم(بلوک‌های سازنده، هدف و زمینه کاربردی آن) الگوی مدل دامنه منبع رویداد بر اساس همان فرض الگوی مدل دامنه است، منطق تجاری پیچیده و متعلق به زیردامنه‌ اصلی است و از الگوهای تاکتیکی مانند اشیا ارزش، تجمیع‌ها و رویدادهای دامنه استفاده می‌کند. تفاوت بین آنها به تداوم وضعیت، تجمیع نهفته  وابسته است، مدل دامنه منبع رویداد از الگوی منبع‌یابی رویداد برای مدیریت حالت‌های تجمیع استفاده میکند(مدل بجای تداوم وضعیت یک تجمیع، رویدادهای دامنه رو تولید میکنه، که هر تغییر رو توصیف و از آنها بعنوان منبع حقیقت برای داده‌های تجمیع استفاده می‌کند)

### در این بخش با معرفی مفهوم منبع رویداد، ترکیب آن با الگوی مدل دامنه و تبدیل آن به یک مدل دامنه منبع رویداد، صحبت میکنیم

# منبع یابی رویداد:
نمودار جریان خود را به من نشان دهید و جداول خود را پنهان کنید، و من همچنان مرموز خواهم بود. جداول خود را به من نشان دهید، و من معمولاً به فلوچارت شما نیاز نخواهم داشت.  آشکار خواهد شد

بیایید از استدلال بالا برای تعریف الگوی منبع یابی رویداد استفاده کنیم و تفاوت آن با مدل سازی سنتی و تداوم داده ها را درک کنیم. تصویر اول در کامنت‌ها را بررسی کنید و آنچه را که می توانید از این داده ها در مورد سیستمی که به آن تعلق دارد بیاموزید، تجزیه و تحلیل کنید.

این یک جدول بازاریابی است که شامل افراد و وضعیت انها می‌باشد که status فیلد وضعیت هر کاربر را مشخص میکند(نفر جدید، خرید شده، عدم خرید و بسته)

این اطلاعات بسیار زیادی است که می‌توانیم فقط با تجزیه و تحلیل طرحواره جدول و داده‌های ذخیره شده در آن جمع‌آوری کنیم. حتی می‌توانیم فرض کنیم که هنگام مدل‌سازی داده‌ها از چه زبانی استفاده شده است. اما از فرآیند کاری که روی هر مشتری صورت گرفته اطلاعی نداریم و این موجب نگرانی‌های کسب و کار می‌شود و نمیتوان تصمیمات درستی در مورد هر مشتری گرفت، حال اگر یه فیلد version روی مدل بزاریم و بابت هر مرحله مشخص انجام شده یک مقدار عددی به آن نسبت بدهیم با یک نگاه گذرا می‌توان به یک سفر در گذشته رفت، برای مثال: مقدار ۱ اطلاعات از مشتری گرفته شده، مقدار ۲ کارشناسان با مشتری تماس گرفته‌اند، مقدار ۳ تاییدیه از مشتری گرفته شده است و ... علاوه بر ان میتوان پی برد چه تعداد مشتری در چه بخش یا واحد سازمان هستند و تحلیل‌های بسیار دیگری 
برای مثال این نوع رویکرد در سفارشات یک فروشگاه از درخواست تا مرحله تحویل را زیر نظر گرفت برای مثال: -ساخت سبد(0)»افزودن کالا(1)»ثبت سبد(2)»پرداخت(3)»در حال بررسی(4)»تخصیص منابع(5)»ارسال(6)»تحویل(7)-

# تجزیه و تحلیل:
بخش هوش تجاری از شما میخواهد در مدل خود برنامه تماس‌های آینده با مشتریان رو فراهم کنید و به این ترتیب با فیلتر این بخش و بخش قبلی به پیش بینی بپردازند، شما باید این پیش بینی رو جایی نگهداری کنید تا بعدا در دسترس باشد، این فرآیند در الگوی CQRS صورت میگرد که در آینده راجب آن حرف خواهیم زد

# منبع حقیقت:
برای اینکه الگوی منبع یابی رویداد کار کند، همه تغییرات در وضعیت یک شی باید به عنوان رویداد نشان داده شود و ادامه یابد. این رویدادها منبع حقیقت سیستم می شوند. مجموعه منبع رویداد پایگاه داده ای که رویدادهای سیستم را ذخیره می کند، تنها ذخیره سازی کاملاً سازگار است: منبع حقیقت سیستم است، نام پذیرفته شده برای پایگاه داده ای که برای رویدادهای ماندگار استفاده می شود، ذخیره رویداد است.

# ذخیره رویداد:
ذخیره رویداد نباید اجازه تغییر یا حذف رویدادها را بدهد، برای پشتیبانی از اجرای الگوی منبع یابی رویداد، حداقل ذخیره رویداد باید از عملکرد زیر پشتیبانی کند: واکشی همه رویدادهای متعلق به یک نهاد تجاری خاص و پیوست رویدادها.

# منبع رویداد مدل دامنه:
مدل اصلی دامنه یک نمایش از حالت تجمیع خود را حفظ می‌کند و رویدادهای دامنه انتخابی را منتشر می‌کند. مدل دامنه منبع رویداد، بطور انحصاری از رویدادهای دامنه برای مدل‌سازی چرخه عمر تجمیع‌ها استفاده می‌کند(تمام تغییرات در وضعیت یک تجمیع باید بعنوان رویدادهای دامنه بیان شوند)

بیایید برخی از مزایای استفاده از منابع رویداد هنگام اجرای منطق پیچیده تجاری نگاهی بیندازیم.

# مزایا:
در مقایسه با مدل سنتی تر، که در آن حالت های فعلی مجموع ها در یک پایگاه داده حفظ می شود، مدل دامنه منبع رویداد به تلاش بیشتری برای مدل سازی کل نیاز دارد. با این حال، این رویکرد دارای مزایای قابل توجهی است که باعث می شود الگو در بسیاری از سناریوها مورد توجه قرار گیرد:


# ویژگی‌ها:
### سفر در زمان:
همانطور که از رویدادهای دامنه می توان برای بازسازی وضعیت فعلی یک مجموعه استفاده کرد، همچنین می توان از آنها برای بازیابی همه حالت های گذشته مجموع استفاده کرد.  به عبارت دیگر، شما همیشه می توانید تمام حالات گذشته یک مجموعه را بازسازی کنید.
 این اغلب هنگام تجزیه و تحلیل رفتار سیستم، بازرسی تصمیمات سیستم و بهینه سازی منطق تجاری انجام می شود.
 یکی دیگر از موارد استفاده رایج برای بازسازی حالت های گذشته، اشکال زدایی ماسبق است:
 شما می توانید مجموع را به حالت دقیقی که در هنگام مشاهده یک باگ بود برگردانید.

### بینش عمیق:
در پست های اول، دیدیم که بهینه‌سازی زیردامنه‌های اصلی از نظر استراتژیک برای تجارت مهم است.  منبع یابی رویداد بینشی عمیق از وضعیت و رفتار سیستم ارائه می دهد.  همانطور که قبلاً در این فصل یاد گرفتید، منبع یابی رویداد مدل انعطاف پذیری را ارائه می دهد که امکان تبدیل رویدادها به بازنمایی حالت های مختلف را فراهم می کند - همیشه می توانید پیش بینی های جدیدی را اضافه کنید که از داده های رویدادهای موجود برای ارائه بینش اضافی استفاده می کند.

### گزارش حسابرسی:
رویدادهای دامنه تداوم یافته یک گزارش حسابرسی کاملاً سازگار از هر اتفاقی که برای حالت‌های کل اتفاق افتاده است را نشان می‌دهد.  قوانین برخی از حوزه‌های تجاری را ملزم به پیاده‌سازی گزارش‌های حسابرسی می‌کند، و منبع‌یابی رویداد این امر را خارج از جعبه فراهم می‌کند.
 این مدل به ویژه برای سیستم هایی که پول یا تراکنش های پولی را مدیریت می کنند مناسب است.  این به ما اجازه می دهد تا به راحتی تصمیمات سیستم و جریان وجوه بین حساب ها را ردیابی کنیم.

### مدیریت همزمان خوش‌بینانه پیشرفته:
مدل کلاسیک هم‌زمانی خوش‌بینانه زمانی که داده‌های خوانده شده کهنه می‌شوند - توسط یک فرآیند دیگر بازنویسی می‌شوند - یک استثنا ایجاد می‌کند. هنگام استفاده از منبع‌یابی رویداد، می‌توانیم بینش عمیق‌تری درباره آنچه که بین خواندن رویدادهای موجود و نوشتن رویدادهای جدید اتفاق افتاده است به دست آوریم.  می‌توانید رویدادهای دقیقی را که همزمان به فروشگاه رویداد ضمیمه شده‌اند پرس و جو کنید و در مورد اینکه آیا رویدادهای جدید با عملیات تلاش‌شده تداخل دارند یا رویدادهای اضافی نامربوط هستند، تصمیم‌گیری مبتنی بر دامنه کسب‌وکار بگیرید یا خیر.

# معایب:
تا کنون ممکن است به نظر برسد که مدل دامنه منبع رویداد، الگوی نهایی برای پیاده سازی منطق تجاری است و بنابراین باید تا حد امکان استفاده شود. البته، این با اصل اجازه دادن به نیازهای حوزه تجاری در تصمیم گیری های طراحی در تضاد است. بنابراین، اجازه دهید برخی از چالش های ارائه شده توسط الگو را مورد بحث قرار دهیم:
### منحنی یادگیری:
نقطه ضعف آشکار الگو تفاوت شدید آن با تکنیک های سنتی مدیریت داده است. اجرای موفقیت آمیز الگو مستلزم آموزش تیم و زمان برای عادت کردن به روش جدید تفکر است. مگر اینکه تیم قبلاً تجربه اجرای سیستم های منبع رویداد را داشته باشد، منحنی یادگیری باید در نظر گرفته شود.

### تکامل مدل:
تکامل یک مدل منبع رویداد می تواند چالش برانگیز باشد. تعریف دقیق منبع رویداد می گوید که رویدادها تغییر ناپذیر هستند. اما اگر بخواهید طرح رویداد را تنظیم کنید چه؟ این فرآیند به سادگی تغییر طرح جدول نیست. در واقع، یک کتاب کامل تنها در مورد این موضوع نوشته شده است: نسخه سازی در یک سیستم منبع رویداد توسط گرگ یانگ.

### پیچیدگی معماری:
پیاده‌سازی منابع رویداد، «قطعات متحرک» معماری متعددی را معرفی می‌کند و طراحی کلی را پیچیده‌تر می‌کند.
همه این چالش‌ها حتی حادتر می‌شوند اگر کار در دست استفاده از الگو را توجیه نکند و در عوض بتوان با طراحی ساده‌تر به آن پرداخت. قوانین ساده ای را یاد خواهید گرفت که می تواند به شما کمک کند تصمیم بگیرید که از کدام الگوی پیاده سازی منطق تجاری استفاده کنید.

</div>



[نویسنده: بهزاد آزادی](https://github.com/behzad-azadi2693)

[وب سایت](https://codecrafters.ir)

[کانال تلگرامی](https://t.me/Code_Crafters)


